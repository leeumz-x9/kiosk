rules_version='2'

service cloud.firestore {
  match /databases/{database}/documents {
    // Careers collection - Read only (public)
    match /careers/{document=**} {
      allow read: if true;
      allow write: if false;
    }

    // Tuition collection - Read only (public)
    match /tuition/{document=**} {
      allow read: if true;
      allow write: if false;
    }

    // Sessions collection - Only write from client (immutable logs)
    match /sessions/{sessionId} {
      allow read: if request.auth != null;
      allow create: if true;
      allow update, delete: if false;
    }

    // Analytics collection - Read only (admin dashboard)
    match /analytics/{document=**} {
      allow read: if true;
      allow write: if false;
    }

    // Heatmap collection - Write from kiosk app
    match /heatmap/{document=**} {
      allow read: if true;
      allow create: if true;
      allow update, delete: if false;
    }

    // LED status collection - Write from Pi5 server
    match /led_status/{document=**} {
      allow read: if true;
      allow write: if true;
    }

    // Presence collection - Write from Pi5 server
    match /presence/{document=**} {
      allow read: if true;
      allow write: if true;
    }
  }
}
