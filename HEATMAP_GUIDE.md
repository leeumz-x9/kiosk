# üî• Heatmap System Guide

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°
Heatmap System ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤

---

## üìä ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

### 1. **‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Auto-Logging)**
- ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ:
  - **x**: ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á X (‡πÄ‡∏õ‡πá‡∏ô % 0-100)
  - **y**: ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á Y (‡πÄ‡∏õ‡πá‡∏ô % 0-100)
  - **page**: ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å (home, explore, etc.)
  - **timestamp**: ‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å

### 2. **Firestore Collection: `heatmap`**
```javascript
{
  x: 45.5,           // % ‡∏à‡∏≤‡∏Å‡∏ã‡πâ‡∏≤‡∏¢
  y: 72.3,           // % ‡∏à‡∏≤‡∏Å‡∏ö‡∏ô
  page: "home",      // ‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
  timestamp: Date    // ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
}
```

### 3. **‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• Real-time**
- Heatmap ‡∏à‡∏∞‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏ö‡∏ö real-time
- ‡∏à‡∏∏‡∏î‡∏™‡∏µ‡πÅ‡∏î‡∏á = ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å (High Traffic)
- ‡∏à‡∏∏‡∏î‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á = ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á (Medium Traffic)
- ‡∏à‡∏∏‡∏î‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß = ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ (Low Traffic)

---

## üéØ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Heatmap (Development Mode)
1. ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î Development: `npm run dev`
2. ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏à‡∏∞‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏° **"üìä ‡πÅ‡∏™‡∏î‡∏á Heatmap"** ‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢
3. ‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô Heatmap

### ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Heatmap (Admin Panel)
1. ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° **‚öôÔ∏è** ‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤
2. ‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™ Admin: **2025**
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π **"üìä Analytics Dashboard"**
4. ‡∏î‡∏π Heatmap ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ï‡πà‡∏≤‡∏á‡πÜ

---

## üìà Dashboard & Analytics

### ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á:
- **‡∏à‡∏∏‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î**: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
- **‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î**: ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
- **Canvas Heatmap**: ‡πÅ‡∏™‡∏î‡∏á‡∏†‡∏≤‡∏û‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å

### ‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:
- üî¥ **‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πâ‡∏ï‡∏≠‡∏ö‡∏™‡∏π‡∏á**: ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å
- üü° **‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πâ‡∏ï‡∏≠‡∏ö‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á**: ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ö‡πà‡∏≠‡∏¢‡∏û‡∏≠‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì
- üü¢ **‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πâ‡∏ï‡∏≠‡∏ö‡∏ô‡πâ‡∏≠‡∏¢**: ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ô‡πâ‡∏≠‡∏¢

---

## üîß ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤

### ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î Heatmap Logging
‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô **App.jsx**:

```javascript
// ‡∏õ‡∏¥‡∏î heatmap logging
const handleScreenClick = (e) => {
  // Comment ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
  // logHeatmapClick(x, y, currentPage);
  handleUserInteraction();
};
```

### ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á
‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô **Heatmap.jsx**:

```javascript
// ‡πÅ‡∏™‡∏î‡∏á 500 ‡∏à‡∏∏‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (default: 100)
const q = query(heatmapRef, orderBy('timestamp', 'desc'), limit(500));
```

### ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î Heatmap Point
‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô **Heatmap.jsx**:

```javascript
// ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏±‡∏®‡∏°‡∏µ‡∏à‡∏≤‡∏Å 40 ‡πÄ‡∏õ‡πá‡∏ô 60
ctx.arc(x, y, 60, 0, Math.PI * 2);
```

---

## üì¶ Firebase Firestore Rules

‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ rules ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö `heatmap` collection:

```javascript
match /heatmap/{heatmapId} {
  allow read: if true;
  allow write: if true;  // Production: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô authenticated users only
}
```

---

## üöÄ Best Practices

### 1. **‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Data Retention**
‡πÉ‡∏ô Firebase Console ‚Üí Firestore ‚Üí TTL Policies:
- ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πà‡∏≤‡∏Å‡∏ß‡πà‡∏≤ 30 ‡∏ß‡∏±‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î storage costs

### 2. **Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞**
```bash
# Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• heatmap ‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô JSON
firebase firestore:export gs://your-bucket/backups
```

### 3. **Aggregate Data**
‡∏™‡∏£‡πâ‡∏≤‡∏á Cloud Function ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
- ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
- ‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô Firestore

### 4. **Index ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Query**
‡∏™‡∏£‡πâ‡∏≤‡∏á composite index:
```
Collection: heatmap
Fields: page (Ascending), timestamp (Descending)
```

---

## üêõ Troubleshooting

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏™‡∏î‡∏á
‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:
1. Firebase ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á (`config.js`)
2. Firestore rules ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï read/write
3. ‡πÄ‡∏õ‡∏¥‡∏î Console ‚Üí Network tab ‡∏î‡∏π error

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Canvas ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á
‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `canvasRef.current` ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô `null`
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö CSS width/height ‡∏Ç‡∏≠‡∏á canvas
3. ‡∏•‡∏≠‡∏á redraw ‡πÇ‡∏î‡∏¢‡∏Å‡∏î toggle ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Real-time ‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó
‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `subscribeToHeatmap` ‡πÉ‡∏ô `firebaseService.js`
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `onSnapshot` listener
3. ‡∏î‡∏π Console ‡∏´‡∏≤ error message

---

## üìö API Reference

### logHeatmapClick(x, y, page)
‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏•‡∏á Firestore

**Parameters:**
- `x` (number): ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á X ‡πÄ‡∏õ‡πá‡∏ô % (0-100)
- `y` (number): ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á Y ‡πÄ‡∏õ‡πá‡∏ô % (0-100)
- `page` (string): ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

**Returns:** Promise<void>

### subscribeToHeatmap(callback)
Subscribe ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• heatmap ‡πÅ‡∏ö‡∏ö real-time

**Parameters:**
- `callback` (function): ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô

**Returns:** Function (unsubscribe)

---

## üé® Customization

### ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ Heatmap
‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô **Heatmap.jsx**:

```javascript
// ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å Red-Yellow-Green ‡πÄ‡∏õ‡πá‡∏ô Blue-Purple-Pink
gradient.addColorStop(0, 'rgba(59, 130, 246, 0.8)');   // Blue
gradient.addColorStop(0.3, 'rgba(147, 51, 234, 0.6)'); // Purple
gradient.addColorStop(0.6, 'rgba(236, 72, 153, 0.3)'); // Pink
```

### ‡πÄ‡∏û‡∏¥‡πà‡∏° Grid Overlay
‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô **Heatmap.jsx**:

```javascript
// ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏∞‡∏¢‡∏∞ grid ‡∏à‡∏≤‡∏Å 50px ‡πÄ‡∏õ‡πá‡∏ô 25px
for (let i = 0; i < width; i += 25) {
  // ...grid drawing code
}
```

---

## üí° Use Cases

1. **Optimize UI Layout**: ‡∏¢‡πâ‡∏≤‡∏¢‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ö‡πà‡∏≠‡∏¢
2. **A/B Testing**: ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö heatmap ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤ A ‡πÅ‡∏•‡∏∞ B
3. **User Flow Analysis**: ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏´‡∏ô‡∏ö‡πâ‡∏≤‡∏á
4. **Dead Zone Detection**: ‡∏´‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏•‡∏¢

---

## üìû Support

‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console logs
2. ‡∏î‡∏π Firestore Console
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Network requests

**Tip**: ‡πÄ‡∏õ‡∏¥‡∏î Development Mode ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π debug logs!

---

**Updated**: January 2026
**Version**: 2.0
